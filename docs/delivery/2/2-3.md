# 2-3 Build work orders management screen

[Back to task list](mdc:tasks.md)

## Description

Create a comprehensive work orders management screen that displays all work orders from the database, allows assignment to contractors/employees, tracks progress, and manages completion status. This screen will complement the maintenance requests system by handling the execution side of maintenance workflows.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2024-12-22 02:15:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2024-12-22 02:15:00 | Status Update | Proposed | Agreed | Task approved for implementation | User |
| 2024-12-22 02:15:00 | Status Update | Agreed | InProgress | Started implementation | AI_Agent |
| 2024-12-22 02:30:00 | Status Update | InProgress | Review | Work orders screen implementation completed | AI_Agent |
| 2024-12-22 02:30:00 | Status Update | Review | Done | Task approved and completed | User |

## Requirements

### Core Functionality
1. **Work Orders List Display**
   - Display all work orders from database using `workOrdersApi.getAll()`
   - Show related maintenance request information
   - Display assigned contractor/employee details
   - Show estimated vs actual costs
   - Progress tracking with visual indicators

2. **Assignment Management**
   - Assign work orders to available contractors/employees
   - View contractor workload and availability
   - Reassignment capabilities
   - Assignment history tracking

3. **Status Management**
   - Update work order status (assigned, in_progress, completed, cancelled)
   - Track start and completion dates
   - Status change confirmations and notifications
   - Progress percentage tracking

4. **Cost Management**
   - Display estimated costs vs actual costs
   - Cost approval workflows
   - Budget tracking and alerts
   - Cost history and adjustments

### UI/UX Requirements
1. **Screen Layout**
   - Header with "Work Orders" title and filter options
   - Tabbed interface: All, Assigned, In Progress, Completed
   - Search and filter capabilities
   - FAB for creating new work orders

2. **Work Order Cards**
   - Work order ID and description
   - Related maintenance request information
   - Assigned contractor with photo/avatar
   - Status indicator with progress bar
   - Cost information (estimated/actual)
   - Due date and priority indicators

3. **Interactive Features**
   - Tap to view detailed work order screen
   - Swipe actions for quick status updates
   - Long press for assignment options
   - Pull-to-refresh functionality

## Implementation Plan

1. **Create Screen Structure**
   - Create `app/maintenance/work-orders.tsx`
   - Implement tabbed interface using Material Design 3 tabs
   - Add ModernHeader with search and filter options

2. **API Integration**
   - Use `workOrdersApi.getAll()` for data fetching
   - Implement useApi hook for state management
   - Add real-time updates for status changes

3. **Work Order Components**
   - Create WorkOrderCard component
   - Implement StatusChip with progress indicators
   - Add AssignmentModal for contractor selection
   - Create CostSummary component

4. **Status Management**
   - Implement status update functions
   - Add confirmation dialogs
   - Integrate with API for persistence
   - Add optimistic UI updates

## Test Plan

### Functional Testing
1. **Data Display**: Verify all work orders display correctly with related information
2. **Assignment**: Test contractor assignment and reassignment workflows
3. **Status Updates**: Verify status changes persist and update UI
4. **Cost Tracking**: Test cost display and update functionality

### Integration Testing
1. **API Integration**: Test all workOrdersApi function calls
2. **Navigation**: Test integration with maintenance system
3. **Real-time Updates**: Verify status changes reflect across screens

## Verification

- [ ] Work orders display with all required information
- [ ] Assignment functionality works correctly
- [ ] Status updates persist to database
- [ ] Cost tracking displays accurately
- [ ] Navigation integrates with maintenance system

## Files Modified

- `app/maintenance/work-orders.tsx` (new file)
- Associated components as needed

## Dependencies

- Existing workOrdersApi functions
- Profiles API for contractor information
- Material Design 3 components
- Navigation integration 