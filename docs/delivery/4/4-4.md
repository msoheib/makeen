# [4-4] Build tenant occupancy reports

[Back to task list](mdc:tasks.md)

## Description

Create comprehensive tenant management report screens including payment history analysis, lease expiry tracking, tenant demographic insights, and occupancy turnover metrics.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2024-12-22 06:35:00 | Status Change | Proposed | InProgress | Started tenant reporting implementation | AI_Agent |

## Requirements

1. **Payment History Report Screen**
   - Tenant payment timeline with status indicators
   - Late payment analysis and trends
   - Payment method distribution
   - Outstanding balance tracking
   - Monthly payment performance charts

2. **Lease Expiry Report Screen**
   - Upcoming lease expirations by month
   - Renewal probability analysis
   - Tenant retention metrics
   - Lease duration distribution
   - Expiry notifications and alerts

3. **Tenant Demographics Screen**
   - Tenant profile analysis (domestic vs foreign)
   - Geographic distribution insights
   - Tenant tenure analysis
   - Property type preferences
   - Revenue per tenant segments

## Implementation Plan

1. **Create Payment History Screen** (`app/(drawer)/reports/payment-history.tsx`)
   - Payment timeline visualization
   - Late payment analysis charts
   - Outstanding balance summaries
   - Payment method breakdown

2. **Create Lease Expiry Screen** (`app/(drawer)/reports/lease-expiry.tsx`)
   - Monthly lease expiration charts
   - Renewal tracking analytics
   - Tenant retention metrics
   - Automated renewal suggestions

3. **Update Navigation**
   - Update main reports screen routing
   - Replace alert messages with actual navigation
   - Test routing to new tenant report screens

## Verification

- [ ] Payment history screen displays real tenant payment data
- [ ] Charts show payment trends and late payment analysis
- [ ] Lease expiry screen shows upcoming expirations
- [ ] All screens have proper loading and error states
- [ ] Navigation from main reports screen works correctly
- [ ] Saudi Riyal currency formatting throughout
- [ ] Material Design 3 UI consistency maintained

## Test Plan

**Objective**: Verify tenant reporting functionality works correctly with database integration

**Test Scenarios**:
1. **Payment History Display**: Payment timeline shows with proper status indicators
2. **Late Payment Analysis**: Charts display late payment trends and amounts
3. **Lease Expiry Tracking**: Upcoming expirations displayed by month
4. **Navigation Integration**: All report screens accessible from main reports page
5. **Error Handling**: Proper error states and retry functionality
6. **Loading States**: Activity indicators during data loading

**Success Criteria**: All tenant report screens functional with real data visualization

## Files Modified

- `app/(drawer)/reports/payment-history.tsx` - Payment analysis screen
- `app/(drawer)/reports/lease-expiry.tsx` - Lease expiration tracking screen  
- `app/(drawer)/(tabs)/reports.tsx` - Updated navigation routing
- API integration through existing `reportsApi` and `profilesApi` endpoints 