# [1-1] Connect tenants screen to profiles API

[Back to task list](mdc:tasks.md)

## Description

Integrate the existing tenants screen (`app/(drawer)/(tabs)/tenants.tsx`) with the profiles API to display real tenant data from the database. This task involves connecting the screen to the existing `profilesApi.getTenants()` function and implementing proper loading states, error handling, and basic tenant list display.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2024-12-21 19:16:00 | Created | N/A | Proposed | Task file created and linked | AI_Agent |
| 2024-12-21 19:18:00 | Status Change | Proposed | Agreed | Task approved for implementation | User |
| 2024-12-21 19:20:00 | Status Change | Agreed | InProgress | Started implementation work | AI_Agent |

## Requirements

### Functional Requirements
1. Display list of all tenants from database using `profilesApi.getTenants()`
2. Show basic tenant information (name, email, phone, property)
3. Implement loading state during API calls
4. Handle API errors with user-friendly messages
5. Maintain existing navigation structure within drawer/tabs

### Technical Requirements
1. Use existing `useApiCall` custom hook from `hooks/useApi.ts`
2. Follow existing design patterns from Dashboard and Properties screens
3. Implement Material Design 3 components for consistency
4. Use TypeScript with proper database types from `lib/database.types.ts`
5. Handle empty state when no tenants exist

### Non-Functional Requirements
1. Loading state should appear within 100ms of screen load
2. Error messages should be clear and actionable
3. UI should be responsive to different screen sizes
4. Follow existing app color scheme and styling

## Implementation Plan

### Phase 1: Basic API Integration
1. Check existing tenants screen structure in `app/(drawer)/(tabs)/tenants.tsx`
2. Import required API functions and custom hooks
3. Implement `useApiCall` for `profilesApi.getTenants()`
4. Add basic loading and error state handling

### Phase 2: UI Implementation
1. Create tenant list component using Material Design 3
2. Display tenant information cards/list items
3. Implement proper loading indicators (shimmer or spinner)
4. Add error state with retry button

### Phase 3: Integration Testing
1. Test API connection and data display
2. Verify loading states function correctly
3. Test error scenarios and recovery
4. Ensure navigation works properly

## Test Plan

### Objective
Verify that the tenants screen successfully connects to the database and displays tenant information with proper loading and error states.

### Test Scope
- API integration functionality
- Loading state behavior
- Error handling and display
- Basic UI rendering

### Key Test Scenarios

1. **Successful Data Load**
   - Screen loads and shows loading state
   - API call succeeds and displays tenant list
   - Loading state disappears after data loads

2. **Empty Data State**
   - API returns empty array
   - Screen displays appropriate empty state message
   - No loading indicators remain visible

3. **Error Handling**
   - API call fails (network error, server error)
   - Screen displays user-friendly error message
   - Retry functionality works if implemented

4. **Navigation Integration**
   - Screen accessible via drawer navigation
   - Tab navigation works correctly
   - Back navigation maintains state

### Success Criteria
- Tenants screen loads without TypeScript errors
- Real tenant data displays from database
- Loading states appear and disappear appropriately
- Error states display helpful messages
- Navigation works seamlessly

## Verification

### Definition of Done
- [ ] Tenants screen displays real data from profiles API
- [ ] Loading state implemented and functioning
- [ ] Error handling displays user-friendly messages
- [ ] TypeScript compilation passes without errors
- [ ] UI follows existing app design patterns
- [ ] Navigation integration works properly
- [ ] No console errors or warnings
- [ ] Manual testing confirms all functionality

### Review Checklist
- [ ] Code follows existing patterns from Dashboard/Properties screens
- [ ] Proper TypeScript types used throughout
- [ ] Error handling covers network and API errors
- [ ] Loading states provide good user experience
- [ ] UI is responsive and accessible

## Files Modified

### Primary Files
- `app/(drawer)/(tabs)/tenants.tsx` - Main tenants screen implementation

### Supporting Files (if needed)
- `components/` - Any new tenant-related components
- `hooks/useApi.ts` - If additional hooks needed
- `lib/api.ts` - If API functions need modification

### Dependencies
- Existing `lib/api.ts` profilesApi functions
- Existing `hooks/useApi.ts` custom hooks
- Existing `lib/database.types.ts` TypeScript types
- React Native Paper components
- React Navigation structure 